[0m10:09:53.187861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105648070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108052400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108013eb0>]}


============================== 10:09:53.190890 | 06784ac0-4a09-4147-b0e7-b6e692167be5 ==============================
[0m10:09:53.190890 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:09:53.191276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:09:53.417125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108052f40>]}
[0m10:09:53.495048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ea1c0>]}
[0m10:09:53.496125 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:09:53.507067 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:09:53.550627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:09:53.551048 [debug] [MainThread]: Partial parsing: added file: dbt_course_learning://models/initial_file.sql
[0m10:09:53.628356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9df40>]}
[0m10:09:53.636193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a6c040>]}
[0m10:09:53.636516 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:09:53.636763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b81af0>]}
[0m10:09:53.637684 [info ] [MainThread]: 
[0m10:09:53.638174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:09:53.638939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:09:53.648301 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:09:53.648701 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:09:53.648931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:54.664336 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m10:09:54.668259 [debug] [ThreadPool]: On list_analytics: Close
[0m10:09:54.760809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_raw)
[0m10:09:54.762436 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "raw"
"
[0m10:09:54.772604 [debug] [ThreadPool]: Using snowflake connection "create_analytics_raw"
[0m10:09:54.773401 [debug] [ThreadPool]: On create_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "create_analytics_raw"} */
create schema if not exists analytics.raw
[0m10:09:54.774022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:55.275678 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:09:55.277814 [debug] [ThreadPool]: On create_analytics_raw: Close
[0m10:09:55.373331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_raw, now list_analytics_raw)
[0m10:09:55.390355 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:09:55.391038 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:09:55.391531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:55.733328 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m10:09:55.736645 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:09:55.825585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078164f0>]}
[0m10:09:55.827510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:09:55.828191 [info ] [MainThread]: 
[0m10:09:55.844376 [debug] [Thread-1  ]: Began running node model.dbt_course_learning.initial_file
[0m10:09:55.845183 [debug] [Thread-2  ]: Began running node model.dbt_course_learning.my_first_dbt_model
[0m10:09:55.845980 [info ] [Thread-1  ]: 1 of 3 START sql view model raw.initial_file ................................... [RUN]
[0m10:09:55.847306 [info ] [Thread-2  ]: 2 of 3 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m10:09:55.850094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.dbt_course_learning.initial_file)
[0m10:09:55.851456 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_course_learning.my_first_dbt_model'
[0m10:09:55.852139 [debug] [Thread-1  ]: Began compiling node model.dbt_course_learning.initial_file
[0m10:09:55.852890 [debug] [Thread-2  ]: Began compiling node model.dbt_course_learning.my_first_dbt_model
[0m10:09:55.861888 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_course_learning.initial_file"
[0m10:09:55.865421 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_course_learning.my_first_dbt_model"
[0m10:09:55.868378 [debug] [Thread-1  ]: Timing info for model.dbt_course_learning.initial_file (compile): 10:09:55.853319 => 10:09:55.867960
[0m10:09:55.868888 [debug] [Thread-1  ]: Began executing node model.dbt_course_learning.initial_file
[0m10:09:55.881616 [debug] [Thread-2  ]: Timing info for model.dbt_course_learning.my_first_dbt_model (compile): 10:09:55.862263 => 10:09:55.881290
[0m10:09:55.887732 [debug] [Thread-2  ]: Began executing node model.dbt_course_learning.my_first_dbt_model
[0m10:09:55.903542 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_course_learning.initial_file"
[0m10:09:55.913503 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_course_learning.my_first_dbt_model"
[0m10:09:55.914975 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_course_learning.initial_file"
[0m10:09:55.915298 [debug] [Thread-1  ]: On model.dbt_course_learning.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.dbt_course_learning.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m10:09:55.915570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:09:55.916103 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_course_learning.my_first_dbt_model"
[0m10:09:55.916782 [debug] [Thread-2  ]: On model.dbt_course_learning.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.dbt_course_learning.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:09:55.917086 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:09:56.316981 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:09:56.350053 [debug] [Thread-1  ]: Timing info for model.dbt_course_learning.initial_file (execute): 10:09:55.869179 => 10:09:56.349754
[0m10:09:56.350664 [debug] [Thread-1  ]: On model.dbt_course_learning.initial_file: Close
[0m10:09:56.453310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb4e20>]}
[0m10:09:56.454435 [info ] [Thread-1  ]: 1 of 3 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.60s]
[0m10:09:56.455351 [debug] [Thread-1  ]: Finished running node model.dbt_course_learning.initial_file
[0m10:09:57.041228 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:09:57.046250 [debug] [Thread-2  ]: Timing info for model.dbt_course_learning.my_first_dbt_model (execute): 10:09:55.894318 => 10:09:57.045859
[0m10:09:57.046988 [debug] [Thread-2  ]: On model.dbt_course_learning.my_first_dbt_model: Close
[0m10:09:57.155422 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc7b20>]}
[0m10:09:57.156674 [info ] [Thread-2  ]: 2 of 3 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.30s]
[0m10:09:57.157735 [debug] [Thread-2  ]: Finished running node model.dbt_course_learning.my_first_dbt_model
[0m10:09:57.159093 [debug] [Thread-4  ]: Began running node model.dbt_course_learning.my_second_dbt_model
[0m10:09:57.160032 [info ] [Thread-4  ]: 3 of 3 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m10:09:57.161415 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_course_learning.my_second_dbt_model'
[0m10:09:57.162120 [debug] [Thread-4  ]: Began compiling node model.dbt_course_learning.my_second_dbt_model
[0m10:09:57.168193 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_course_learning.my_second_dbt_model"
[0m10:09:57.170117 [debug] [Thread-4  ]: Timing info for model.dbt_course_learning.my_second_dbt_model (compile): 10:09:57.162543 => 10:09:57.169669
[0m10:09:57.170996 [debug] [Thread-4  ]: Began executing node model.dbt_course_learning.my_second_dbt_model
[0m10:09:57.176493 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_course_learning.my_second_dbt_model"
[0m10:09:57.178122 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_course_learning.my_second_dbt_model"
[0m10:09:57.178670 [debug] [Thread-4  ]: On model.dbt_course_learning.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.dbt_course_learning.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m10:09:57.179167 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:09:57.846971 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:09:57.850314 [debug] [Thread-4  ]: Timing info for model.dbt_course_learning.my_second_dbt_model (execute): 10:09:57.171416 => 10:09:57.849662
[0m10:09:57.850979 [debug] [Thread-4  ]: On model.dbt_course_learning.my_second_dbt_model: Close
[0m10:09:57.935747 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06784ac0-4a09-4147-b0e7-b6e692167be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf37c0>]}
[0m10:09:57.936686 [info ] [Thread-4  ]: 3 of 3 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.77s]
[0m10:09:57.937435 [debug] [Thread-4  ]: Finished running node model.dbt_course_learning.my_second_dbt_model
[0m10:09:57.939196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:57.939552 [debug] [MainThread]: Connection 'model.dbt_course_learning.initial_file' was properly closed.
[0m10:09:57.939872 [debug] [MainThread]: Connection 'model.dbt_course_learning.my_first_dbt_model' was properly closed.
[0m10:09:57.940187 [debug] [MainThread]: Connection 'model.dbt_course_learning.my_second_dbt_model' was properly closed.
[0m10:09:57.940551 [info ] [MainThread]: 
[0m10:09:57.940950 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m10:09:57.942035 [debug] [MainThread]: Command end result
[0m10:09:57.953574 [info ] [MainThread]: 
[0m10:09:57.954063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:09:57.954403 [info ] [MainThread]: 
[0m10:09:57.954751 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:09:57.956521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.81554, "process_user_time": 2.152128, "process_kernel_time": 0.245694, "process_mem_max_rss": "134856704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:09:57.957047 [debug] [MainThread]: Command `dbt run` succeeded at 10:09:57.956923 after 4.82 seconds
[0m10:09:57.957432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105648070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c3d90>]}
[0m10:09:57.957806 [debug] [MainThread]: Flushing usage events
[0m10:13:34.534317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c4e80>]}


============================== 10:13:34.537597 | 54a91446-763a-4543-8bf5-cc91efb1d964 ==============================
[0m10:13:34.537597 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:13:34.537971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select customers.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:13:34.753773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54a91446-763a-4543-8bf5-cc91efb1d964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f4f40>]}
[0m10:13:34.832121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54a91446-763a-4543-8bf5-cc91efb1d964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb1a90>]}
[0m10:13:34.833235 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:13:34.844150 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:13:34.884527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:13:34.884835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:13:34.888607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54a91446-763a-4543-8bf5-cc91efb1d964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072320d0>]}
[0m10:13:34.895977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54a91446-763a-4543-8bf5-cc91efb1d964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714d790>]}
[0m10:13:34.896353 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:13:34.896606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a91446-763a-4543-8bf5-cc91efb1d964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714da30>]}
[0m10:13:34.897509 [info ] [MainThread]: 
[0m10:13:34.898024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:13:34.898682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:13:34.908789 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:13:34.909126 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:13:34.909355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:35.349530 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:13:35.353047 [debug] [ThreadPool]: On list_analytics: Close
[0m10:13:35.447583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m10:13:35.463563 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:13:35.464367 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:13:35.465051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:35.838629 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:13:35.840664 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:13:35.930096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a91446-763a-4543-8bf5-cc91efb1d964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efdb50>]}
[0m10:13:35.931947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:35.932732 [info ] [MainThread]: 
[0m10:13:35.936662 [debug] [Thread-1  ]: Began running node model.dbt_course_learning.customers
[0m10:13:35.937503 [info ] [Thread-1  ]: 1 of 1 START sql view model raw.customers ...................................... [RUN]
[0m10:13:35.938826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.dbt_course_learning.customers)
[0m10:13:35.939524 [debug] [Thread-1  ]: Began compiling node model.dbt_course_learning.customers
[0m10:13:35.952001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_course_learning.customers"
[0m10:13:35.953709 [debug] [Thread-1  ]: Timing info for model.dbt_course_learning.customers (compile): 10:13:35.939936 => 10:13:35.953288
[0m10:13:35.954419 [debug] [Thread-1  ]: Began executing node model.dbt_course_learning.customers
[0m10:13:35.987303 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_course_learning.customers"
[0m10:13:35.989317 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_course_learning.customers"
[0m10:13:35.989747 [debug] [Thread-1  ]: On model.dbt_course_learning.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.dbt_course_learning.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:13:35.990135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:13:36.471723 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:13:36.506796 [debug] [Thread-1  ]: Timing info for model.dbt_course_learning.customers (execute): 10:13:35.954755 => 10:13:36.506497
[0m10:13:36.507436 [debug] [Thread-1  ]: On model.dbt_course_learning.customers: Close
[0m10:13:36.597776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a91446-763a-4543-8bf5-cc91efb1d964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073edc70>]}
[0m10:13:36.599078 [info ] [Thread-1  ]: 1 of 1 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.66s]
[0m10:13:36.600076 [debug] [Thread-1  ]: Finished running node model.dbt_course_learning.customers
[0m10:13:36.602269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:36.602774 [debug] [MainThread]: Connection 'model.dbt_course_learning.customers' was properly closed.
[0m10:13:36.603234 [info ] [MainThread]: 
[0m10:13:36.603672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m10:13:36.604690 [debug] [MainThread]: Command end result
[0m10:13:36.615544 [info ] [MainThread]: 
[0m10:13:36.616165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:36.616612 [info ] [MainThread]: 
[0m10:13:36.617163 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:13:36.619373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1271567, "process_user_time": 1.727496, "process_kernel_time": 0.202255, "process_mem_max_rss": "129056768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:13:36.620036 [debug] [MainThread]: Command `dbt run` succeeded at 10:13:36.619898 after 2.13 seconds
[0m10:13:36.620493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef90a0>]}
[0m10:13:36.620930 [debug] [MainThread]: Flushing usage events
[0m10:15:01.249279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110192190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110153550>]}


============================== 10:15:01.252039 | 63463717-84af-474a-b43a-9026496f3946 ==============================
[0m10:15:01.252039 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:15:01.252410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'version_check': 'True', 'profiles_dir': '/Users/yiting.chen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:15:01.459153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101694c0>]}
[0m10:15:01.537531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b9b0a0>]}
[0m10:15:01.538308 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:15:01.549011 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:15:01.595440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:01.595754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:01.599652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fbd0d0>]}
[0m10:15:01.613924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecd850>]}
[0m10:15:01.614286 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:15:01.614537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecda00>]}
[0m10:15:01.615544 [info ] [MainThread]: 
[0m10:15:01.616031 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:01.616740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:15:01.625471 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:15:01.625781 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:15:01.626001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:02.133382 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:15:02.136639 [debug] [ThreadPool]: On list_analytics: Close
[0m10:15:02.239088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m10:15:02.253531 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:15:02.254518 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:15:02.255041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:02.564246 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:15:02.568511 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:15:02.662618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107156400>]}
[0m10:15:02.664807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:02.666382 [info ] [MainThread]: 
[0m10:15:02.670172 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m10:15:02.671040 [debug] [Thread-2  ]: Began running node model.jaffle_shop.initial_file
[0m10:15:02.672739 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m10:15:02.671970 [info ] [Thread-1  ]: 1 of 4 START sql view model raw.customers ...................................... [RUN]
[0m10:15:02.674432 [info ] [Thread-2  ]: 2 of 4 START sql view model raw.initial_file ................................... [RUN]
[0m10:15:02.675475 [info ] [Thread-3  ]: 3 of 4 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m10:15:02.676896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.customers)
[0m10:15:02.678954 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.initial_file'
[0m10:15:02.681370 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m10:15:02.682308 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m10:15:02.682948 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.initial_file
[0m10:15:02.683520 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m10:15:02.694173 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:15:02.696666 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m10:15:02.700801 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m10:15:02.702944 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (compile): 10:15:02.683870 => 10:15:02.702636
[0m10:15:02.703480 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (compile): 10:15:02.694569 => 10:15:02.703226
[0m10:15:02.703929 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m10:15:02.704441 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.initial_file
[0m10:15:02.704942 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 10:15:02.697053 => 10:15:02.704711
[0m10:15:02.736687 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m10:15:02.740924 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m10:15:02.744350 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:15:02.758709 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m10:15:02.760494 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m10:15:02.760867 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m10:15:02.761148 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:15:02.761462 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m10:15:02.761706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:15:02.762213 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m10:15:02.762451 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:15:02.762883 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:15:02.763607 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:15:03.151748 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:15:03.179949 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:15:03.196677 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (execute): 10:15:02.717706 => 10:15:03.196424
[0m10:15:03.193012 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (execute): 10:15:02.705190 => 10:15:03.192759
[0m10:15:03.197494 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: Close
[0m10:15:03.197991 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m10:15:03.287294 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ab8b0>]}
[0m10:15:03.289307 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11238cbb0>]}
[0m10:15:03.288334 [info ] [Thread-2  ]: 2 of 4 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.61s]
[0m10:15:03.290180 [info ] [Thread-1  ]: 1 of 4 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.61s]
[0m10:15:03.290902 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.initial_file
[0m10:15:03.291538 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m10:15:03.811023 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:15:03.817665 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 10:15:02.744533 => 10:15:03.817087
[0m10:15:03.818718 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m10:15:03.913551 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ffb2b0>]}
[0m10:15:03.914999 [info ] [Thread-3  ]: 3 of 4 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m10:15:03.916305 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m10:15:03.917613 [debug] [Thread-4  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m10:15:03.918460 [info ] [Thread-4  ]: 4 of 4 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m10:15:03.919815 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m10:15:03.920471 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m10:15:03.925608 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m10:15:03.927394 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 10:15:03.920834 => 10:15:03.927026
[0m10:15:03.928022 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m10:15:03.933943 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m10:15:03.935688 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m10:15:03.936254 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m10:15:03.936734 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:15:04.380062 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:15:04.387868 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 10:15:03.928381 => 10:15:04.387393
[0m10:15:04.388689 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m10:15:04.485881 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63463717-84af-474a-b43a-9026496f3946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e1a00>]}
[0m10:15:04.487270 [info ] [Thread-4  ]: 4 of 4 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.57s]
[0m10:15:04.488357 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m10:15:04.491398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:04.492115 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:15:04.492954 [debug] [MainThread]: Connection 'model.jaffle_shop.initial_file' was properly closed.
[0m10:15:04.493657 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m10:15:04.494276 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m10:15:04.495141 [info ] [MainThread]: 
[0m10:15:04.495839 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m10:15:04.497577 [debug] [MainThread]: Command end result
[0m10:15:04.511439 [info ] [MainThread]: 
[0m10:15:04.512073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:04.512549 [info ] [MainThread]: 
[0m10:15:04.513089 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:15:04.515379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.306329, "process_user_time": 1.962369, "process_kernel_time": 0.21253, "process_mem_max_rss": "131284992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:15:04.516164 [debug] [MainThread]: Command `dbt run` succeeded at 10:15:04.515998 after 3.31 seconds
[0m10:15:04.516918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122430a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b9b0a0>]}
[0m10:15:04.517574 [debug] [MainThread]: Flushing usage events
[0m10:15:48.762431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c93b80>]}


============================== 10:15:48.765166 | 9a529a64-f1d9-4a8c-bff1-a04d12b78654 ==============================
[0m10:15:48.765166 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:15:48.765552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'debug': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:15:48.972890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd3730>]}
[0m10:15:49.050707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543f370>]}
[0m10:15:49.051529 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:15:49.062003 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:15:49.104646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:49.104945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:49.108852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e80d0>]}
[0m10:15:49.115491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fc7f0>]}
[0m10:15:49.115836 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:15:49.116079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fca90>]}
[0m10:15:49.117068 [info ] [MainThread]: 
[0m10:15:49.117546 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:49.118273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:15:49.126726 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:15:49.127006 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:15:49.127211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:49.519702 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:15:49.523042 [debug] [ThreadPool]: On list_analytics: Close
[0m10:15:49.615708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m10:15:49.632091 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:15:49.632800 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:15:49.633301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:50.022781 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:15:50.026721 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:15:50.131824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104599460>]}
[0m10:15:50.134069 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:50.135311 [info ] [MainThread]: 
[0m10:15:50.139248 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m10:15:50.140151 [debug] [Thread-2  ]: Began running node model.jaffle_shop.initial_file
[0m10:15:50.140944 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m10:15:50.143188 [info ] [Thread-1  ]: 1 of 4 START sql view model raw.customers ...................................... [RUN]
[0m10:15:50.145260 [info ] [Thread-2  ]: 2 of 4 START sql view model raw.initial_file ................................... [RUN]
[0m10:15:50.147055 [info ] [Thread-3  ]: 3 of 4 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m10:15:50.149032 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.customers)
[0m10:15:50.150289 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.initial_file'
[0m10:15:50.151534 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m10:15:50.152169 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m10:15:50.152751 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.initial_file
[0m10:15:50.153296 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m10:15:50.164140 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:15:50.167516 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m10:15:50.171200 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m10:15:50.172635 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (compile): 10:15:50.164539 => 10:15:50.172332
[0m10:15:50.173173 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 10:15:50.167975 => 10:15:50.172917
[0m10:15:50.173628 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (compile): 10:15:50.153638 => 10:15:50.173417
[0m10:15:50.174076 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.initial_file
[0m10:15:50.174545 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m10:15:50.174972 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m10:15:50.214298 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m10:15:50.217570 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m10:15:50.219936 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:15:50.220867 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m10:15:50.221400 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m10:15:50.221659 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m10:15:50.222697 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m10:15:50.222966 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:15:50.223223 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:15:50.223494 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    

with customers as (

    select
        id as customer_id
        ...

)

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:15:50.223776 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:15:50.224205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:15:50.574460 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:15:50.593697 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (execute): 10:15:50.175246 => 10:15:50.593506
[0m10:15:50.596028 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: Close
[0m10:15:50.603326 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4d32b-0000-e8f5-0000-0001ae72806d
[0m10:15:50.603662 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 8 unexpected '.'.
syntax error line 14 at position 0 unexpected 'with'.
[0m10:15:50.604131 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (execute): 10:15:50.217743 => 10:15:50.603916
[0m10:15:50.604512 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m10:15:50.698592 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105926790>]}
[0m10:15:50.699255 [info ] [Thread-2  ]: 2 of 4 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.55s]
[0m10:15:50.699795 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.initial_file
[0m10:15:50.700827 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected '.'.
  syntax error line 14 at position 0 unexpected 'with'.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m10:15:50.701208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ff370>]}
[0m10:15:50.701660 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model raw.customers ............................. [[31mERROR[0m in 0.55s]
[0m10:15:50.702136 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m10:15:50.898752 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:15:50.908436 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 10:15:50.193875 => 10:15:50.908013
[0m10:15:50.909280 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m10:15:51.004792 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059232e0>]}
[0m10:15:51.006380 [info ] [Thread-3  ]: 3 of 4 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.85s]
[0m10:15:51.008174 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m10:15:51.009967 [debug] [Thread-4  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m10:15:51.011160 [info ] [Thread-4  ]: 4 of 4 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m10:15:51.012989 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m10:15:51.013917 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m10:15:51.020833 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m10:15:51.022406 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 10:15:51.014438 => 10:15:51.022012
[0m10:15:51.023011 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m10:15:51.030044 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m10:15:51.032067 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m10:15:51.032655 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m10:15:51.033155 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:15:51.523294 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:15:51.530213 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 10:15:51.023361 => 10:15:51.529488
[0m10:15:51.531293 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m10:15:51.623753 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a529a64-f1d9-4a8c-bff1-a04d12b78654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b90280>]}
[0m10:15:51.625179 [info ] [Thread-4  ]: 4 of 4 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.61s]
[0m10:15:51.626281 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m10:15:51.629066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:51.629727 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:15:51.630281 [debug] [MainThread]: Connection 'model.jaffle_shop.initial_file' was properly closed.
[0m10:15:51.630802 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m10:15:51.631377 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m10:15:51.632433 [info ] [MainThread]: 
[0m10:15:51.633199 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m10:15:51.635257 [debug] [MainThread]: Command end result
[0m10:15:51.647841 [info ] [MainThread]: 
[0m10:15:51.648488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:15:51.648995 [info ] [MainThread]: 
[0m10:15:51.649439 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected '.'.
  syntax error line 14 at position 0 unexpected 'with'.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m10:15:51.650102 [info ] [MainThread]: 
[0m10:15:51.651259 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:15:51.653486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9307468, "process_user_time": 1.987889, "process_kernel_time": 0.21274, "process_mem_max_rss": "131923968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:15:51.654169 [debug] [MainThread]: Command `dbt run` failed at 10:15:51.653992 after 2.93 seconds
[0m10:15:51.654680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c93b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106684b50>]}
[0m10:15:51.655123 [debug] [MainThread]: Flushing usage events
[0m10:16:16.681139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024269d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104187730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041483d0>]}


============================== 10:16:16.683705 | c40e6d48-288f-429a-99ba-cbe89df23e39 ==============================
[0m10:16:16.683705 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:16:16.684068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'profiles_dir': '/Users/yiting.chen/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:16.897060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104187730>]}
[0m10:16:16.977868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ea520>]}
[0m10:16:16.978640 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:16:16.988954 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:16:17.032851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:17.033183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:17.036961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9c0d0>]}
[0m10:16:17.043379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb07c0>]}
[0m10:16:17.043717 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:16:17.043962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb0a60>]}
[0m10:16:17.044944 [info ] [MainThread]: 
[0m10:16:17.045432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:16:17.046174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:16:17.054779 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:16:17.055095 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:16:17.055301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:17.515824 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:16:17.519667 [debug] [ThreadPool]: On list_analytics: Close
[0m10:16:17.616004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m10:16:17.631173 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:16:17.632676 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:16:17.633383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:18.007102 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:16:18.011456 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:16:18.100318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b16d90>]}
[0m10:16:18.102393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:18.103382 [info ] [MainThread]: 
[0m10:16:18.107314 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m10:16:18.108177 [debug] [Thread-2  ]: Began running node model.jaffle_shop.initial_file
[0m10:16:18.109170 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m10:16:18.110128 [info ] [Thread-1  ]: 1 of 4 START sql view model raw.customers ...................................... [RUN]
[0m10:16:18.111557 [info ] [Thread-2  ]: 2 of 4 START sql view model raw.initial_file ................................... [RUN]
[0m10:16:18.113896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.customers)
[0m10:16:18.112511 [info ] [Thread-3  ]: 3 of 4 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m10:16:18.115918 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.initial_file'
[0m10:16:18.117059 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m10:16:18.118629 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m10:16:18.119623 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.initial_file
[0m10:16:18.131743 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:16:18.132348 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m10:16:18.135343 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m10:16:18.138863 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m10:16:18.139637 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (compile): 10:16:18.120027 => 10:16:18.139378
[0m10:16:18.140065 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m10:16:18.146850 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (compile): 10:16:18.132719 => 10:16:18.146635
[0m10:16:18.153788 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.initial_file
[0m10:16:18.160679 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 10:16:18.135859 => 10:16:18.160461
[0m10:16:18.177897 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m10:16:18.179533 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:16:18.179826 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m10:16:18.195362 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m10:16:18.195851 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m10:16:18.196957 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m10:16:18.197278 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m10:16:18.197608 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:16:18.197914 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:16:18.198169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:16:18.198680 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m10:16:18.199515 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:16:18.199924 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:16:18.579119 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:16:18.607424 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:16:18.618809 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (execute): 10:16:18.140378 => 10:16:18.618551
[0m10:16:18.621781 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (execute): 10:16:18.160885 => 10:16:18.621561
[0m10:16:18.622264 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m10:16:18.622682 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: Close
[0m10:16:18.715975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb3340>]}
[0m10:16:18.717436 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0bdc0>]}
[0m10:16:18.718383 [info ] [Thread-1  ]: 1 of 4 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.60s]
[0m10:16:18.719371 [info ] [Thread-2  ]: 2 of 4 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.60s]
[0m10:16:18.720153 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m10:16:18.720830 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.initial_file
[0m10:16:19.000913 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:16:19.006518 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 10:16:18.180149 => 10:16:19.006124
[0m10:16:19.007649 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m10:16:19.103304 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd40d0>]}
[0m10:16:19.105457 [info ] [Thread-3  ]: 3 of 4 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.99s]
[0m10:16:19.106545 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m10:16:19.107781 [debug] [Thread-4  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m10:16:19.109351 [info ] [Thread-4  ]: 4 of 4 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m10:16:19.110975 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m10:16:19.111802 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m10:16:19.119437 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m10:16:19.121324 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 10:16:19.112331 => 10:16:19.120895
[0m10:16:19.121947 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m10:16:19.127976 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m10:16:19.129817 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m10:16:19.130503 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m10:16:19.131387 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:16:19.517783 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:16:19.525315 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 10:16:19.122308 => 10:16:19.524555
[0m10:16:19.527010 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m10:16:19.624985 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e6d48-288f-429a-99ba-cbe89df23e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3baf0>]}
[0m10:16:19.626723 [info ] [Thread-4  ]: 4 of 4 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.51s]
[0m10:16:19.628498 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m10:16:19.631514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:19.632221 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:16:19.633207 [debug] [MainThread]: Connection 'model.jaffle_shop.initial_file' was properly closed.
[0m10:16:19.634955 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m10:16:19.635791 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m10:16:19.636506 [info ] [MainThread]: 
[0m10:16:19.637180 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m10:16:19.638871 [debug] [MainThread]: Command end result
[0m10:16:19.653897 [info ] [MainThread]: 
[0m10:16:19.654528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:19.654969 [info ] [MainThread]: 
[0m10:16:19.655403 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:16:19.657706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0186274, "process_user_time": 2.023478, "process_kernel_time": 0.209921, "process_mem_max_rss": "131923968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:16:19.658550 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:19.658349 after 3.02 seconds
[0m10:16:19.659158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024269d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ea520>]}
[0m10:16:19.659745 [debug] [MainThread]: Flushing usage events
[0m10:16:36.987408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124530d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123fca30>]}


============================== 10:16:36.990606 | 34c39f26-a4d8-48af-8ac8-ae917b458b84 ==============================
[0m10:16:36.990606 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:16:36.991113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:37.195301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11242bf40>]}
[0m10:16:37.275844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e32250>]}
[0m10:16:37.276624 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:16:37.287986 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:16:37.361649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:37.362526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:37.368249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bd0d0>]}
[0m10:16:37.378880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132cc820>]}
[0m10:16:37.379485 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:16:37.379837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132cc9d0>]}
[0m10:16:37.382189 [info ] [MainThread]: 
[0m10:16:37.385564 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:16:37.386985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:16:37.398494 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:16:37.399307 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:16:37.399587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:37.820143 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:16:37.823301 [debug] [ThreadPool]: On list_analytics: Close
[0m10:16:37.913120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m10:16:37.924712 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:16:37.925320 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:16:37.925744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:38.248268 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:16:38.251505 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:16:38.341419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132cc970>]}
[0m10:16:38.342711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:38.343196 [info ] [MainThread]: 
[0m10:16:38.345944 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m10:16:38.346612 [debug] [Thread-2  ]: Began running node model.jaffle_shop.initial_file
[0m10:16:38.347346 [info ] [Thread-1  ]: 1 of 4 START sql view model raw.customers ...................................... [RUN]
[0m10:16:38.347969 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m10:16:38.349513 [info ] [Thread-2  ]: 2 of 4 START sql view model raw.initial_file ................................... [RUN]
[0m10:16:38.351180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.customers)
[0m10:16:38.351912 [info ] [Thread-3  ]: 3 of 4 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m10:16:38.352954 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.initial_file'
[0m10:16:38.354036 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m10:16:38.354967 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m10:16:38.355458 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.initial_file
[0m10:16:38.366491 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:16:38.367051 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m10:16:38.369927 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m10:16:38.373773 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m10:16:38.374714 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (compile): 10:16:38.355761 => 10:16:38.374404
[0m10:16:38.375194 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m10:16:38.381821 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 10:16:38.370406 => 10:16:38.381397
[0m10:16:38.388931 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (compile): 10:16:38.367398 => 10:16:38.388628
[0m10:16:38.389342 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m10:16:38.405761 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:16:38.406131 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.initial_file
[0m10:16:38.423434 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m10:16:38.426129 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m10:16:38.427383 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m10:16:38.427719 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:16:38.428011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:16:38.428958 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m10:16:38.429230 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:16:38.429615 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m10:16:38.429849 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:16:38.430357 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m10:16:38.430903 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:16:38.851289 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:16:38.887729 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (execute): 10:16:38.423739 => 10:16:38.887428
[0m10:16:38.888332 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: Close
[0m10:16:38.895852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:16:38.899320 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (execute): 10:16:38.375540 => 10:16:38.899077
[0m10:16:38.899920 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m10:16:38.971126 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ff8280>]}
[0m10:16:38.972203 [info ] [Thread-2  ]: 2 of 4 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.62s]
[0m10:16:38.973116 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.initial_file
[0m10:16:38.984634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e57d60>]}
[0m10:16:38.986080 [info ] [Thread-1  ]: 1 of 4 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.63s]
[0m10:16:38.987168 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m10:16:39.188086 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:16:39.194396 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 10:16:38.406344 => 10:16:39.193960
[0m10:16:39.195314 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m10:16:39.288691 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e33d90>]}
[0m10:16:39.290241 [info ] [Thread-3  ]: 3 of 4 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.93s]
[0m10:16:39.291837 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m10:16:39.293401 [debug] [Thread-4  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m10:16:39.294390 [info ] [Thread-4  ]: 4 of 4 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m10:16:39.295629 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m10:16:39.296205 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m10:16:39.301555 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m10:16:39.303034 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 10:16:39.296774 => 10:16:39.302684
[0m10:16:39.303679 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m10:16:39.309350 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m10:16:39.310942 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m10:16:39.311558 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m10:16:39.312117 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:16:39.713437 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:16:39.719623 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 10:16:39.304108 => 10:16:39.718828
[0m10:16:39.720554 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m10:16:39.818300 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c39f26-a4d8-48af-8ac8-ae917b458b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f6fa60>]}
[0m10:16:39.819625 [info ] [Thread-4  ]: 4 of 4 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.52s]
[0m10:16:39.820692 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m10:16:39.823577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:39.824220 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:16:39.824711 [debug] [MainThread]: Connection 'model.jaffle_shop.initial_file' was properly closed.
[0m10:16:39.825162 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m10:16:39.825616 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m10:16:39.826126 [info ] [MainThread]: 
[0m10:16:39.826660 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m10:16:39.828365 [debug] [MainThread]: Command end result
[0m10:16:39.841438 [info ] [MainThread]: 
[0m10:16:39.842145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:39.842657 [info ] [MainThread]: 
[0m10:16:39.843169 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:16:39.845944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9017894, "process_user_time": 1.984104, "process_kernel_time": 0.206521, "process_mem_max_rss": "131334144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:16:39.846820 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:39.846614 after 2.90 seconds
[0m10:16:39.847788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113010880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113054d30>]}
[0m10:16:39.848385 [debug] [MainThread]: Flushing usage events
[0m10:18:47.404366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eba400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7beb0>]}


============================== 10:18:47.407635 | 66d7bb37-1d49-495b-b923-e44c1f5db98a ==============================
[0m10:18:47.407635 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:18:47.408032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:18:47.626468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1bca0>]}
[0m10:18:47.704761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ec4f0>]}
[0m10:18:47.705841 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:18:47.716887 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:18:47.761204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:47.761499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:47.765331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad20d0>]}
[0m10:18:47.771883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e08e0>]}
[0m10:18:47.772201 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:18:47.772445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e0a90>]}
[0m10:18:47.773453 [info ] [MainThread]: 
[0m10:18:47.773942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:18:47.774647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:18:47.783873 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:18:47.784213 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:18:47.784433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:48.266790 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:18:48.270287 [debug] [ThreadPool]: On list_analytics: Close
[0m10:18:48.360804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m10:18:48.375300 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:18:48.375998 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:18:48.376492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:48.788784 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:18:48.793201 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:18:48.889099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108782490>]}
[0m10:18:48.891254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:48.892364 [info ] [MainThread]: 
[0m10:18:48.897051 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m10:18:48.897903 [debug] [Thread-2  ]: Began running node model.jaffle_shop.initial_file
[0m10:18:48.898651 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m10:18:48.899549 [info ] [Thread-1  ]: 1 of 4 START sql view model raw.customers ...................................... [RUN]
[0m10:18:48.901452 [info ] [Thread-2  ]: 2 of 4 START sql view model raw.initial_file ................................... [RUN]
[0m10:18:48.902589 [info ] [Thread-3  ]: 3 of 4 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m10:18:48.903769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.customers)
[0m10:18:48.905381 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.initial_file'
[0m10:18:48.907413 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m10:18:48.908057 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m10:18:48.908707 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.initial_file
[0m10:18:48.909318 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m10:18:48.924436 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m10:18:48.925171 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:18:48.928414 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m10:18:48.929769 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (compile): 10:18:48.909690 => 10:18:48.929507
[0m10:18:48.930313 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 10:18:48.925512 => 10:18:48.930037
[0m10:18:48.930779 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (compile): 10:18:48.922408 => 10:18:48.930564
[0m10:18:48.931189 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m10:18:48.933638 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m10:18:48.934166 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.initial_file
[0m10:18:48.976428 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m10:18:48.976884 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:18:48.979250 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m10:18:48.980560 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m10:18:48.981940 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m10:18:48.982456 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m10:18:48.982754 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m10:18:48.983084 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:18:48.983422 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:18:48.983692 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:18:48.983934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:48.984183 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:18:49.379049 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:18:49.415149 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (execute): 10:18:48.934496 => 10:18:49.414848
[0m10:18:49.415760 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m10:18:49.436023 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:18:49.439774 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (execute): 10:18:48.977051 => 10:18:49.439530
[0m10:18:49.440244 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: Close
[0m10:18:49.497552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a95fa0>]}
[0m10:18:49.498611 [info ] [Thread-1  ]: 1 of 4 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.59s]
[0m10:18:49.499456 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m10:18:49.528007 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10964e790>]}
[0m10:18:49.528823 [info ] [Thread-2  ]: 2 of 4 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.62s]
[0m10:18:49.529558 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.initial_file
[0m10:18:49.765982 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:18:49.772836 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 10:18:48.945495 => 10:18:49.772397
[0m10:18:49.773725 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m10:18:49.865967 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c22fa0>]}
[0m10:18:49.867415 [info ] [Thread-3  ]: 3 of 4 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m10:18:49.869410 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m10:18:49.871297 [debug] [Thread-4  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m10:18:49.872247 [info ] [Thread-4  ]: 4 of 4 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m10:18:49.873692 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m10:18:49.874750 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m10:18:49.882683 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m10:18:49.885296 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 10:18:49.875273 => 10:18:49.884731
[0m10:18:49.886238 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m10:18:49.891701 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m10:18:49.893093 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m10:18:49.893612 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m10:18:49.894105 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:18:50.276214 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:18:50.283432 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 10:18:49.886644 => 10:18:50.282850
[0m10:18:50.284951 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m10:18:50.378598 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66d7bb37-1d49-495b-b923-e44c1f5db98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c635e0>]}
[0m10:18:50.380087 [info ] [Thread-4  ]: 4 of 4 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.51s]
[0m10:18:50.381913 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m10:18:50.385994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:50.387495 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:18:50.388181 [debug] [MainThread]: Connection 'model.jaffle_shop.initial_file' was properly closed.
[0m10:18:50.388730 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m10:18:50.389269 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m10:18:50.389915 [info ] [MainThread]: 
[0m10:18:50.390570 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m10:18:50.392563 [debug] [MainThread]: Command end result
[0m10:18:50.407140 [info ] [MainThread]: 
[0m10:18:50.407853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:50.408350 [info ] [MainThread]: 
[0m10:18:50.408815 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:18:50.411078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0491762, "process_user_time": 1.991398, "process_kernel_time": 0.218259, "process_mem_max_rss": "131350528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:18:50.411794 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:50.411627 after 3.05 seconds
[0m10:18:50.412301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098786d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1bca0>]}
[0m10:18:50.412792 [debug] [MainThread]: Flushing usage events
[0m10:41:22.233839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104622670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106406400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c7eb0>]}


============================== 10:41:22.237228 | 49711666-9f74-4d04-993a-1e711058b4bd ==============================
[0m10:41:22.237228 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:41:22.237637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:22.461160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104167ca0>]}
[0m10:41:22.536284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e384f0>]}
[0m10:41:22.537511 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m10:41:22.547771 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m10:41:22.592402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:22.592693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:22.596501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701d0d0>]}
[0m10:41:22.602838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2c8e0>]}
[0m10:41:22.603147 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m10:41:22.603395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2ca90>]}
[0m10:41:22.604353 [info ] [MainThread]: 
[0m10:41:22.604824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:41:22.605521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:41:22.614162 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:41:22.614546 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:41:22.614777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:23.086631 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:41:23.088456 [debug] [ThreadPool]: On list_analytics: Close
[0m10:41:23.176488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m10:41:23.188318 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m10:41:23.188889 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m10:41:23.189330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:23.519466 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:41:23.525758 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m10:41:23.623979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ccf490>]}
[0m10:41:23.626302 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:41:23.627457 [info ] [MainThread]: 
[0m10:41:23.632591 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m10:41:23.633475 [debug] [Thread-2  ]: Began running node model.jaffle_shop.initial_file
[0m10:41:23.634171 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m10:41:23.635029 [info ] [Thread-1  ]: 1 of 4 START sql view model raw.customers ...................................... [RUN]
[0m10:41:23.636490 [info ] [Thread-2  ]: 2 of 4 START sql view model raw.initial_file ................................... [RUN]
[0m10:41:23.637350 [info ] [Thread-3  ]: 3 of 4 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m10:41:23.638746 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.customers)
[0m10:41:23.640457 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.initial_file'
[0m10:41:23.641704 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m10:41:23.642452 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m10:41:23.643053 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.initial_file
[0m10:41:23.643646 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m10:41:23.655602 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:41:23.658176 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m10:41:23.661734 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m10:41:23.663120 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (compile): 10:41:23.644023 => 10:41:23.662817
[0m10:41:23.663749 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m10:41:23.670665 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (compile): 10:41:23.655985 => 10:41:23.670385
[0m10:41:23.671213 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 10:41:23.658580 => 10:41:23.670951
[0m10:41:23.683674 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.initial_file
[0m10:41:23.692909 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:41:23.693291 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m10:41:23.696182 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m10:41:23.711684 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m10:41:23.712275 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m10:41:23.713278 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m10:41:23.713536 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m10:41:23.713870 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:41:23.714181 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:41:23.714693 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m10:41:23.714922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:41:23.715541 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:41:23.716389 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:41:24.137961 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:41:24.173410 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (execute): 10:41:23.664117 => 10:41:24.173098
[0m10:41:24.174060 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m10:41:24.176182 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:41:24.179426 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.initial_file (execute): 10:41:23.693492 => 10:41:24.179141
[0m10:41:24.179888 [debug] [Thread-2  ]: On model.jaffle_shop.initial_file: Close
[0m10:41:24.270870 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc3a30>]}
[0m10:41:24.272144 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe1fa0>]}
[0m10:41:24.273125 [info ] [Thread-2  ]: 2 of 4 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.63s]
[0m10:41:24.274602 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.initial_file
[0m10:41:24.273794 [info ] [Thread-1  ]: 1 of 4 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.63s]
[0m10:41:24.275542 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m10:41:24.850821 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:41:24.857336 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 10:41:23.696480 => 10:41:24.856922
[0m10:41:24.858149 [debug] [Thread-3  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m10:41:24.946146 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c942b0>]}
[0m10:41:24.947548 [info ] [Thread-3  ]: 3 of 4 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.30s]
[0m10:41:24.948694 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m10:41:24.949980 [debug] [Thread-4  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m10:41:24.950857 [info ] [Thread-4  ]: 4 of 4 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m10:41:24.952248 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m10:41:24.952934 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m10:41:24.958384 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m10:41:24.960025 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 10:41:24.953368 => 10:41:24.959659
[0m10:41:24.960613 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m10:41:24.965584 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m10:41:24.967289 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m10:41:24.967891 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m10:41:24.968404 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:41:25.503872 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:41:25.509810 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 10:41:24.960960 => 10:41:25.509418
[0m10:41:25.510612 [debug] [Thread-4  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m10:41:25.625454 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49711666-9f74-4d04-993a-1e711058b4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c942b0>]}
[0m10:41:25.626703 [info ] [Thread-4  ]: 4 of 4 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m10:41:25.627788 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m10:41:25.630462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:25.631253 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:41:25.631802 [debug] [MainThread]: Connection 'model.jaffle_shop.initial_file' was properly closed.
[0m10:41:25.632339 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m10:41:25.632878 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m10:41:25.633497 [info ] [MainThread]: 
[0m10:41:25.634221 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m10:41:25.636050 [debug] [MainThread]: Command end result
[0m10:41:25.649018 [info ] [MainThread]: 
[0m10:41:25.649921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:25.650435 [info ] [MainThread]: 
[0m10:41:25.651001 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:41:25.653471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.46585, "process_user_time": 1.914135, "process_kernel_time": 0.21833, "process_mem_max_rss": "130744320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:41:25.654226 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:25.654056 after 3.47 seconds
[0m10:41:25.654733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104622670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107054ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104167ca0>]}
[0m10:41:25.655236 [debug] [MainThread]: Flushing usage events
[0m13:29:01.510502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029b27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c8a30>]}


============================== 13:29:01.513794 | dc6cb590-bdcd-41c1-b382-2d7907f0ed3a ==============================
[0m13:29:01.513794 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:29:01.514195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'profiles_dir': '/Users/yiting.chen/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:29:01.742668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e96d0>]}
[0m13:29:01.817919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec5be0>]}
[0m13:29:01.819128 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:29:01.830659 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:29:01.875349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:01.875677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:01.879533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105343f40>]}
[0m13:29:01.886414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052441c0>]}
[0m13:29:01.886714 [info ] [MainThread]: Found 6 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m13:29:01.886961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052440d0>]}
[0m13:29:01.887979 [info ] [MainThread]: 
[0m13:29:01.888460 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:29:01.889277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m13:29:01.898586 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m13:29:01.898908 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m13:29:01.899120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:02.950621 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:29:02.953881 [debug] [ThreadPool]: On list_analytics: Close
[0m13:29:03.050451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m13:29:03.065626 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m13:29:03.066241 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m13:29:03.066734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:03.492765 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:29:03.498103 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m13:29:03.601267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe63d0>]}
[0m13:29:03.602745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:03.603406 [info ] [MainThread]: 
[0m13:29:03.607711 [debug] [Thread-1  ]: Began running node model.jaffle_shop.initial_file
[0m13:29:03.608344 [debug] [Thread-2  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:29:03.609181 [info ] [Thread-1  ]: 1 of 6 START sql view model raw.initial_file ................................... [RUN]
[0m13:29:03.610555 [info ] [Thread-2  ]: 2 of 6 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m13:29:03.609867 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_customers
[0m13:29:03.611669 [debug] [Thread-4  ]: Began running node model.jaffle_shop.stg_orders
[0m13:29:03.612650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.initial_file)
[0m13:29:03.613824 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m13:29:03.614909 [info ] [Thread-3  ]: 3 of 6 START sql view model raw.stg_customers .................................. [RUN]
[0m13:29:03.615890 [info ] [Thread-4  ]: 4 of 6 START sql view model raw.stg_orders ..................................... [RUN]
[0m13:29:03.616643 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.initial_file
[0m13:29:03.617270 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:29:03.618321 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m13:29:03.619319 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:29:03.628725 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m13:29:03.632113 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:29:03.632607 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_customers
[0m13:29:03.633067 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.stg_orders
[0m13:29:03.635441 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:29:03.638831 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:29:03.639570 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (compile): 13:29:03.619693 => 13:29:03.639299
[0m13:29:03.640187 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 13:29:03.629072 => 13:29:03.639963
[0m13:29:03.640575 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.initial_file
[0m13:29:03.641040 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:29:03.641524 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (compile): 13:29:03.633535 => 13:29:03.641290
[0m13:29:03.641946 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (compile): 13:29:03.635825 => 13:29:03.641744
[0m13:29:03.678086 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m13:29:03.678462 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_customers
[0m13:29:03.681466 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:29:03.681787 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.stg_orders
[0m13:29:03.684128 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:29:03.686445 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:29:03.686994 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m13:29:03.687321 [debug] [Thread-1  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m13:29:03.687823 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m13:29:03.688049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:03.688448 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:29:03.688816 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:29:03.689062 [debug] [Thread-2  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m13:29:03.689795 [debug] [Thread-3  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view analytics.raw.stg_customers
  
   as (
    select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.customers
  );
[0m13:29:03.690094 [debug] [Thread-4  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view analytics.raw.stg_orders
  
   as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.orders
  );
[0m13:29:03.690603 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:29:03.690871 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:29:03.691102 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:29:04.095645 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:29:04.121203 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:29:04.127994 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (execute): 13:29:03.684368 => 13:29:04.127700
[0m13:29:04.133464 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (execute): 13:29:03.642157 => 13:29:04.133233
[0m13:29:04.133953 [debug] [Thread-4  ]: On model.jaffle_shop.stg_orders: Close
[0m13:29:04.134379 [debug] [Thread-1  ]: On model.jaffle_shop.initial_file: Close
[0m13:29:04.186395 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:29:04.188228 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (execute): 13:29:03.682007 => 13:29:04.188088
[0m13:29:04.188493 [debug] [Thread-3  ]: On model.jaffle_shop.stg_customers: Close
[0m13:29:04.216537 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e6c40>]}
[0m13:29:04.217138 [info ] [Thread-1  ]: 1 of 6 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.60s]
[0m13:29:04.217643 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.initial_file
[0m13:29:04.218373 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c0ee0>]}
[0m13:29:04.218980 [info ] [Thread-4  ]: 4 of 6 OK created sql view model raw.stg_orders ................................ [[32mSUCCESS 1[0m in 0.60s]
[0m13:29:04.219504 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.stg_orders
[0m13:29:04.270323 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe63d0>]}
[0m13:29:04.270975 [info ] [Thread-3  ]: 3 of 6 OK created sql view model raw.stg_customers ............................. [[32mSUCCESS 1[0m in 0.65s]
[0m13:29:04.271497 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_customers
[0m13:29:04.272030 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m13:29:04.272473 [info ] [Thread-1  ]: 5 of 6 START sql view model raw.customers ...................................... [RUN]
[0m13:29:04.273075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.initial_file, now model.jaffle_shop.customers)
[0m13:29:04.273408 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m13:29:04.276653 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:29:04.277575 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (compile): 13:29:04.273605 => 13:29:04.277356
[0m13:29:04.277916 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m13:29:04.280817 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:29:04.282222 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:29:04.282566 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    

with customers as (

    select * from analytics.raw.stg_customers

),

orders as (

    select * from analytics.raw.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:29:04.282890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:04.709219 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:29:04.717280 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.customers (execute): 13:29:04.278117 => 13:29:04.716845
[0m13:29:04.718132 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m13:29:04.817048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d2ca0>]}
[0m13:29:04.818239 [info ] [Thread-1  ]: 5 of 6 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.54s]
[0m13:29:04.819284 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m13:29:05.217681 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:29:05.224763 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 13:29:03.653757 => 13:29:05.224322
[0m13:29:05.225547 [debug] [Thread-2  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:29:05.326519 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551a9a0>]}
[0m13:29:05.328221 [info ] [Thread-2  ]: 2 of 6 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.71s]
[0m13:29:05.329385 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:29:05.330660 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:29:05.331647 [info ] [Thread-3  ]: 6 of 6 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m13:29:05.332938 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.my_second_dbt_model)
[0m13:29:05.333648 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:29:05.341109 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:29:05.342741 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 13:29:05.334070 => 13:29:05.342361
[0m13:29:05.343330 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:29:05.349072 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:29:05.350663 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m13:29:05.351217 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m13:29:05.351705 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:29:05.739310 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:29:05.751260 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 13:29:05.343673 => 13:29:05.750590
[0m13:29:05.752613 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:29:05.850077 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6cb590-bdcd-41c1-b382-2d7907f0ed3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d2790>]}
[0m13:29:05.851441 [info ] [Thread-3  ]: 6 of 6 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.52s]
[0m13:29:05.852533 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:29:05.855236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:05.855772 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:29:05.856230 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m13:29:05.856659 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:29:05.857075 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:29:05.857608 [info ] [MainThread]: 
[0m13:29:05.858603 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m13:29:05.860502 [debug] [MainThread]: Command end result
[0m13:29:05.874762 [info ] [MainThread]: 
[0m13:29:05.875370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:05.875807 [info ] [MainThread]: 
[0m13:29:05.876254 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:29:05.878147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4161916, "process_user_time": 2.072087, "process_kernel_time": 0.223889, "process_mem_max_rss": "133021696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:29:05.878730 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:05.878593 after 4.42 seconds
[0m13:29:05.879167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029b27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec5be0>]}
[0m13:29:05.879606 [debug] [MainThread]: Flushing usage events
[0m13:31:47.999092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c50730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c123d0>]}


============================== 13:31:48.002035 | 0ee21ee8-af7e-4ea8-9b9d-e43276539461 ==============================
[0m13:31:48.002035 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:31:48.002450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:31:48.222092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c50730>]}
[0m13:31:48.297761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c26a0>]}
[0m13:31:48.298555 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:31:48.308877 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:31:48.352702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:31:48.353115 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/sources.yml
[0m13:31:48.353384 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/stg_orders.sql
[0m13:31:48.353629 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/stg_customers.sql
[0m13:31:48.474903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc10d0>]}
[0m13:31:48.481414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a98f3a0>]}
[0m13:31:48.481716 [info ] [MainThread]: Found 6 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m13:31:48.481961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a5250>]}
[0m13:31:48.482933 [info ] [MainThread]: 
[0m13:31:48.483405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:31:48.484235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m13:31:48.492978 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m13:31:48.493356 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m13:31:48.493561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:49.118174 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:31:49.120957 [debug] [ThreadPool]: On list_analytics: Close
[0m13:31:49.212294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_raw)
[0m13:31:49.220678 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m13:31:49.221081 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m13:31:49.221350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:49.579261 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m13:31:49.584381 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m13:31:49.690915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d0820>]}
[0m13:31:49.692549 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:49.693218 [info ] [MainThread]: 
[0m13:31:49.696965 [debug] [Thread-1  ]: Began running node model.jaffle_shop.initial_file
[0m13:31:49.697807 [debug] [Thread-2  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:31:49.699364 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_customers
[0m13:31:49.700555 [debug] [Thread-4  ]: Began running node model.jaffle_shop.stg_orders
[0m13:31:49.698703 [info ] [Thread-1  ]: 1 of 6 START sql view model raw.initial_file ................................... [RUN]
[0m13:31:49.701468 [info ] [Thread-2  ]: 2 of 6 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m13:31:49.702256 [info ] [Thread-3  ]: 3 of 6 START sql view model raw.stg_customers .................................. [RUN]
[0m13:31:49.703032 [info ] [Thread-4  ]: 4 of 6 START sql view model raw.stg_orders ..................................... [RUN]
[0m13:31:49.704224 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.initial_file)
[0m13:31:49.705936 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m13:31:49.707135 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m13:31:49.708248 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:31:49.708833 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.initial_file
[0m13:31:49.709385 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:31:49.709923 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_customers
[0m13:31:49.710445 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.stg_orders
[0m13:31:49.719856 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m13:31:49.723684 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:31:49.726915 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:31:49.729923 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:31:49.731356 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (compile): 13:31:49.724043 => 13:31:49.731046
[0m13:31:49.731883 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (compile): 13:31:49.710796 => 13:31:49.731642
[0m13:31:49.732305 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_customers
[0m13:31:49.732805 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 13:31:49.720273 => 13:31:49.732554
[0m13:31:49.733237 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (compile): 13:31:49.727229 => 13:31:49.733038
[0m13:31:49.733701 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.initial_file
[0m13:31:49.746745 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:31:49.759538 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:31:49.759916 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.stg_orders
[0m13:31:49.762592 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.initial_file"
[0m13:31:49.777592 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:31:49.779859 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:31:49.780513 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:31:49.780825 [debug] [Thread-3  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view analytics.raw.stg_customers
  
   as (
    select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.customers
  );
[0m13:31:49.781195 [debug] [Thread-1  ]: Using snowflake connection "model.jaffle_shop.initial_file"
[0m13:31:49.781440 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:31:49.781709 [debug] [Thread-1  ]: On model.jaffle_shop.initial_file: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.initial_file"} */
create or replace   view analytics.raw.initial_file
  
   as (
    select * from raw.jaffle_shop.customers
  );
[0m13:31:49.782656 [debug] [Thread-2  ]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m13:31:49.783040 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:31:49.783532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:31:49.783824 [debug] [Thread-2  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table analytics.raw.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m13:31:49.784105 [debug] [Thread-4  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view analytics.raw.stg_orders
  
   as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.orders
  );
[0m13:31:49.784633 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:31:49.785235 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:31:50.244088 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:31:50.268322 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:31:50.285464 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (execute): 13:31:49.733966 => 13:31:50.285160
[0m13:31:50.286484 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (execute): 13:31:49.760110 => 13:31:50.286277
[0m13:31:50.286928 [debug] [Thread-3  ]: On model.jaffle_shop.stg_customers: Close
[0m13:31:50.287959 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:31:50.288366 [debug] [Thread-1  ]: On model.jaffle_shop.initial_file: Close
[0m13:31:50.291971 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (execute): 13:31:49.775452 => 13:31:50.291771
[0m13:31:50.293623 [debug] [Thread-4  ]: On model.jaffle_shop.stg_orders: Close
[0m13:31:50.388386 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfdee0>]}
[0m13:31:50.389344 [info ] [Thread-4  ]: 4 of 6 OK created sql view model raw.stg_orders ................................ [[32mSUCCESS 1[0m in 0.68s]
[0m13:31:50.390116 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.stg_orders
[0m13:31:50.394310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9afac0>]}
[0m13:31:50.395052 [info ] [Thread-1  ]: 1 of 6 OK created sql view model raw.initial_file .............................. [[32mSUCCESS 1[0m in 0.69s]
[0m13:31:50.395865 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.initial_file
[0m13:31:50.408051 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d0820>]}
[0m13:31:50.408846 [info ] [Thread-3  ]: 3 of 6 OK created sql view model raw.stg_customers ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m13:31:50.409540 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_customers
[0m13:31:50.410180 [debug] [Thread-4  ]: Began running node model.jaffle_shop.customers
[0m13:31:50.410667 [info ] [Thread-4  ]: 5 of 6 START sql view model raw.customers ...................................... [RUN]
[0m13:31:50.411413 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m13:31:50.411824 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.customers
[0m13:31:50.415869 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:31:50.417301 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.customers (compile): 13:31:50.412102 => 13:31:50.417016
[0m13:31:50.417723 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.customers
[0m13:31:50.421332 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:31:50.423079 [debug] [Thread-4  ]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:31:50.423500 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view analytics.raw.customers
  
   as (
    

with customers as (

    select * from analytics.raw.stg_customers

),

orders as (

    select * from analytics.raw.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:31:50.423896 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:31:50.793843 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:31:50.802356 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 13:31:49.762796 => 13:31:50.801800
[0m13:31:50.803311 [debug] [Thread-2  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:31:51.054530 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:31:51.060000 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.customers (execute): 13:31:50.417948 => 13:31:51.059588
[0m13:31:51.061066 [debug] [Thread-4  ]: On model.jaffle_shop.customers: Close
[0m13:31:51.129663 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8aedc0>]}
[0m13:31:51.130928 [info ] [Thread-2  ]: 2 of 6 OK created sql table model raw.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.42s]
[0m13:31:51.132015 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:31:51.133127 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:31:51.133946 [info ] [Thread-3  ]: 6 of 6 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m13:31:51.135164 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.my_second_dbt_model)
[0m13:31:51.135871 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:31:51.141329 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:31:51.143052 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 13:31:51.136297 => 13:31:51.142713
[0m13:31:51.143612 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:31:51.150395 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:31:51.151868 [debug] [Thread-3  ]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m13:31:51.152368 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view analytics.raw.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from analytics.raw.my_first_dbt_model
where id = 1
  );
[0m13:31:51.153263 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:31:51.162020 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc36d60>]}
[0m13:31:51.162866 [info ] [Thread-4  ]: 5 of 6 OK created sql view model raw.customers ................................. [[32mSUCCESS 1[0m in 0.75s]
[0m13:31:51.163599 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.customers
[0m13:31:51.605154 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:31:51.614553 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 13:31:51.144046 => 13:31:51.614115
[0m13:31:51.615410 [debug] [Thread-3  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:31:51.732946 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee21ee8-af7e-4ea8-9b9d-e43276539461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d1940>]}
[0m13:31:51.734305 [info ] [Thread-3  ]: 6 of 6 OK created sql view model raw.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.60s]
[0m13:31:51.735612 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:31:51.738283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:51.738868 [debug] [MainThread]: Connection 'model.jaffle_shop.initial_file' was properly closed.
[0m13:31:51.739405 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m13:31:51.740001 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:31:51.740508 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:31:51.741114 [info ] [MainThread]: 
[0m13:31:51.741736 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m13:31:51.743713 [debug] [MainThread]: Command end result
[0m13:31:51.756802 [info ] [MainThread]: 
[0m13:31:51.757394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:51.757829 [info ] [MainThread]: 
[0m13:31:51.758278 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:31:51.760692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8053107, "process_user_time": 2.159282, "process_kernel_time": 0.215968, "process_mem_max_rss": "136544256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:31:51.761393 [debug] [MainThread]: Command `dbt run` succeeded at 13:31:51.761233 after 3.81 seconds
[0m13:31:51.761916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5f1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab45fd0>]}
[0m13:31:51.762411 [debug] [MainThread]: Flushing usage events
[0m13:32:46.761442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d13400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd5eb0>]}


============================== 13:32:46.764303 | 5e09b5f5-4432-48bf-bd9a-e374d291e16b ==============================
[0m13:32:46.764303 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:32:46.764710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:46.977834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e09b5f5-4432-48bf-bd9a-e374d291e16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ad190>]}
[0m13:32:47.052712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e09b5f5-4432-48bf-bd9a-e374d291e16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab40d90>]}
[0m13:32:47.053472 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:32:47.063413 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:32:47.107981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:32:47.108435 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/schema.yml
[0m13:32:47.213706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e09b5f5-4432-48bf-bd9a-e374d291e16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0370d0>]}
[0m13:32:47.221088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e09b5f5-4432-48bf-bd9a-e374d291e16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebcb20>]}
[0m13:32:47.221403 [info ] [MainThread]: Found 6 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m13:32:47.221643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e09b5f5-4432-48bf-bd9a-e374d291e16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e89d0>]}
[0m13:32:47.222939 [info ] [MainThread]: 
[0m13:32:47.223432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:32:47.224238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_raw'
[0m13:32:47.234204 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m13:32:47.234518 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m13:32:47.234728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:47.768626 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:32:47.773480 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m13:32:47.868776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e09b5f5-4432-48bf-bd9a-e374d291e16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd4490>]}
[0m13:32:47.870384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:47.871074 [info ] [MainThread]: 
[0m13:32:47.875194 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:32:47.875902 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:32:47.876589 [info ] [Thread-1  ]: 1 of 13 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m13:32:47.877404 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:32:47.877980 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:47.878535 [info ] [Thread-2  ]: 2 of 13 START test not_null_customers_customer_id .............................. [RUN]
[0m13:32:47.879583 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m13:32:47.880189 [info ] [Thread-3  ]: 3 of 13 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m13:32:47.880844 [info ] [Thread-4  ]: 4 of 13 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:32:47.882072 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d'
[0m13:32:47.882719 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:32:47.883770 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:32:47.885550 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m13:32:47.886293 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:32:47.898415 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:32:47.898963 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:32:47.899401 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:47.910521 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:32:47.914825 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:32:47.919135 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:32:47.920180 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:32:47.899676 => 13:32:47.919927
[0m13:32:47.920612 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 13:32:47.886658 => 13:32:47.920406
[0m13:32:47.920973 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:32:47.921362 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:32:47.927685 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 13:32:47.910933 => 13:32:47.927508
[0m13:32:47.928011 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 13:32:47.915152 => 13:32:47.927860
[0m13:32:47.944284 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:32:47.946609 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:32:47.946892 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:32:47.947164 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:47.949341 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:32:47.951824 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:32:47.952596 [debug] [Thread-1  ]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:32:47.953047 [debug] [Thread-2  ]: Using snowflake connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:32:47.953313 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from analytics.raw.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m13:32:47.953632 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from analytics.raw.customers
where customer_id is null



      
    ) dbt_internal_test
[0m13:32:47.953965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:32:47.954418 [debug] [Thread-4  ]: Using snowflake connection "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:32:47.954641 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:32:47.955045 [debug] [Thread-3  ]: Using snowflake connection "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:32:47.956467 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from analytics.raw.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:32:47.955748 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from analytics.raw.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:32:47.956746 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:32:47.957248 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:32:48.456470 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:48.468135 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 13:32:47.935296 => 13:32:48.467604
[0m13:32:48.468863 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m13:32:48.547037 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:48.551369 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 13:32:47.947472 => 13:32:48.550808
[0m13:32:48.552213 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:32:48.576853 [info ] [Thread-1  ]: 1 of 13 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.70s]
[0m13:32:48.578088 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:32:48.578890 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:32:48.579715 [info ] [Thread-1  ]: 5 of 13 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:32:48.581081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:32:48.581914 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:32:48.589466 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:32:48.591870 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 13:32:48.582384 => 13:32:48.591510
[0m13:32:48.592485 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:32:48.596509 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:32:48.598325 [debug] [Thread-1  ]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:32:48.598926 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from analytics.raw.stg_customers
where customer_id is null



      
    ) dbt_internal_test
[0m13:32:48.599499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:32:48.644648 [error] [Thread-3  ]: 3 of 13 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.76s]
[0m13:32:48.645427 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:32:48.645913 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:32:48.646432 [info ] [Thread-3  ]: 6 of 13 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:32:48.647410 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:32:48.647933 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:32:48.654136 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:32:48.655361 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 13:32:48.648359 => 13:32:48.655100
[0m13:32:48.655765 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:32:48.659068 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:32:48.660122 [debug] [Thread-3  ]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:32:48.660487 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from analytics.raw.stg_orders
where customer_id is null



      
    ) dbt_internal_test
[0m13:32:48.660818 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:32:48.676859 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:48.677482 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:48.679231 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:32:47.921595 => 13:32:48.679015
[0m13:32:48.680654 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 13:32:47.949562 => 13:32:48.680474
[0m13:32:48.680994 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m13:32:48.681300 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:32:48.839581 [info ] [Thread-4  ]: 4 of 13 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.96s]
[0m13:32:48.840413 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:48.840906 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:32:48.841427 [info ] [Thread-4  ]: 7 of 13 START test not_null_stg_orders_order_id ................................ [RUN]
[0m13:32:48.842233 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:32:48.842673 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:32:48.847917 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:32:48.849618 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 13:32:48.842944 => 13:32:48.849049
[0m13:32:48.850158 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:32:48.853653 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:32:48.854971 [debug] [Thread-4  ]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:32:48.855379 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from analytics.raw.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m13:32:48.855757 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:32:48.894912 [info ] [Thread-2  ]: 2 of 13 PASS not_null_customers_customer_id .................................... [[32mPASS[0m in 1.01s]
[0m13:32:48.895840 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:32:48.896672 [debug] [Thread-2  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:32:48.897173 [info ] [Thread-2  ]: 8 of 13 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:32:48.897876 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:32:48.898344 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:32:48.903839 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:32:48.905109 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 13:32:48.898726 => 13:32:48.904887
[0m13:32:48.905483 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:32:48.908964 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:32:48.910159 [debug] [Thread-2  ]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:32:48.910507 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from analytics.raw.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from analytics.raw.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:32:48.910832 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:32:49.004834 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:49.006674 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 13:32:48.655997 => 13:32:49.006457
[0m13:32:49.007052 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:32:49.108104 [info ] [Thread-3  ]: 6 of 13 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.46s]
[0m13:32:49.108843 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:32:49.109332 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:32:49.109837 [info ] [Thread-3  ]: 9 of 13 START test unique_customers_customer_id ................................ [RUN]
[0m13:32:49.110645 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m13:32:49.111094 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:32:49.118812 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:32:49.120131 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:32:49.111359 => 13:32:49.119884
[0m13:32:49.120553 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:32:49.123829 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:32:49.125046 [debug] [Thread-3  ]: Using snowflake connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:32:49.125457 [debug] [Thread-3  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.raw.customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:49.125854 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:32:49.149339 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:49.151485 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 13:32:48.592797 => 13:32:49.151239
[0m13:32:49.151919 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:32:49.156045 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:49.157950 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 13:32:48.850439 => 13:32:49.157726
[0m13:32:49.158508 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:32:49.266212 [info ] [Thread-4  ]: 7 of 13 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.42s]
[0m13:32:49.267017 [info ] [Thread-1  ]: 5 of 13 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.69s]
[0m13:32:49.267768 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:32:49.268320 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:32:49.268759 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:32:49.269220 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:49.269666 [info ] [Thread-4  ]: 10 of 13 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m13:32:49.270108 [info ] [Thread-1  ]: 11 of 13 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:32:49.270782 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m13:32:49.271391 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:32:49.271804 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:32:49.272175 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:49.276777 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:32:49.281472 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:32:49.282589 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 13:32:49.277143 => 13:32:49.282329
[0m13:32:49.282974 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 13:32:49.272399 => 13:32:49.282793
[0m13:32:49.283298 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:49.283600 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:32:49.286083 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:32:49.288429 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:32:49.289463 [debug] [Thread-1  ]: Using snowflake connection "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:32:49.290047 [debug] [Thread-4  ]: Using snowflake connection "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:32:49.290337 [debug] [Thread-1  ]: On test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.raw.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:49.290647 [debug] [Thread-4  ]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.raw.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:49.290929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:32:49.291182 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:32:49.357915 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:49.359587 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 13:32:48.905690 => 13:32:49.359381
[0m13:32:49.359933 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:32:49.457565 [info ] [Thread-2  ]: 8 of 13 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.56s]
[0m13:32:49.458259 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:32:49.458693 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:32:49.459147 [info ] [Thread-2  ]: 12 of 13 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:32:49.459840 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m13:32:49.460185 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:32:49.464161 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:32:49.465128 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 13:32:49.460387 => 13:32:49.464911
[0m13:32:49.465480 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:32:49.468424 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:32:49.469887 [debug] [Thread-2  ]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:32:49.470235 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.raw.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:49.470543 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:32:49.577342 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:49.579159 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:32:49.120795 => 13:32:49.578944
[0m13:32:49.579531 [debug] [Thread-3  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m13:32:49.603111 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:49.604898 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 13:32:49.286294 => 13:32:49.604672
[0m13:32:49.605291 [debug] [Thread-4  ]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:32:49.639213 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:49.641294 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 13:32:49.283784 => 13:32:49.641035
[0m13:32:49.641740 [debug] [Thread-1  ]: On test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:32:49.668296 [info ] [Thread-3  ]: 9 of 13 PASS unique_customers_customer_id ...................................... [[32mPASS[0m in 0.56s]
[0m13:32:49.669078 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:32:49.669614 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:32:49.670118 [info ] [Thread-3  ]: 13 of 13 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:32:49.670909 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:32:49.671343 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:32:49.719754 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:32:49.722047 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 13:32:49.671602 => 13:32:49.721853
[0m13:32:49.722337 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:32:49.724380 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:32:49.725141 [info ] [Thread-4  ]: 10 of 13 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.45s]
[0m13:32:49.725517 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:32:49.726521 [debug] [Thread-3  ]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:32:49.726957 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from analytics.raw.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:49.727290 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:32:49.776664 [info ] [Thread-1  ]: 11 of 13 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.51s]
[0m13:32:49.777182 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:49.875554 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:49.877605 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 13:32:49.465680 => 13:32:49.877366
[0m13:32:49.878015 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:32:49.984416 [info ] [Thread-2  ]: 12 of 13 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.52s]
[0m13:32:49.985638 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:32:50.086085 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:50.092020 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 13:32:49.722502 => 13:32:50.091427
[0m13:32:50.092893 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:32:50.202208 [info ] [Thread-3  ]: 13 of 13 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.53s]
[0m13:32:50.203421 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:32:50.206084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:50.206655 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:32:50.207193 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:32:50.207693 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:32:50.208187 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:32:50.208757 [info ] [MainThread]: 
[0m13:32:50.209393 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m13:32:50.213077 [debug] [MainThread]: Command end result
[0m13:32:50.228177 [info ] [MainThread]: 
[0m13:32:50.228725 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:32:50.229137 [info ] [MainThread]: 
[0m13:32:50.229544 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m13:32:50.229936 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:32:50.230312 [info ] [MainThread]: 
[0m13:32:50.230691 [info ] [MainThread]:   compiled Code at target/compiled/jaffle_shop/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m13:32:50.231101 [info ] [MainThread]: 
[0m13:32:50.231520 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m13:32:50.233877 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.5170007, "process_user_time": 2.379849, "process_kernel_time": 0.224134, "process_mem_max_rss": "139296768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:50.235098 [debug] [MainThread]: Command `dbt test` failed at 13:32:50.234902 after 3.52 seconds
[0m13:32:50.235594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae21280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebcc40>]}
[0m13:32:50.236065 [debug] [MainThread]: Flushing usage events
[0m13:33:33.023011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10228e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104073400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104034eb0>]}


============================== 13:33:33.026000 | a236c301-eb4b-485b-bff1-a86e0a447d68 ==============================
[0m13:33:33.026000 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:33:33.026398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:33.241972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a236c301-eb4b-485b-bff1-a86e0a447d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104073f40>]}
[0m13:33:33.316311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a236c301-eb4b-485b-bff1-a86e0a447d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9dd90>]}
[0m13:33:33.317069 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:33:33.327659 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:33:33.372677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:33.372968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:33.376851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a236c301-eb4b-485b-bff1-a86e0a447d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caa0d0>]}
[0m13:33:33.384220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a236c301-eb4b-485b-bff1-a86e0a447d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba7460>]}
[0m13:33:33.384529 [info ] [MainThread]: Found 6 models, 12 tests, 2 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m13:33:33.384772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a236c301-eb4b-485b-bff1-a86e0a447d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba74f0>]}
[0m13:33:33.386056 [info ] [MainThread]: 
[0m13:33:33.386539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:33:33.387369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_raw'
[0m13:33:33.397079 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m13:33:33.398145 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m13:33:33.398434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:33.946822 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:33:33.951383 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m13:33:34.065627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a236c301-eb4b-485b-bff1-a86e0a447d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10393a490>]}
[0m13:33:34.067466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:34.068209 [info ] [MainThread]: 
[0m13:33:34.072287 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:33:34.072966 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:33:34.073548 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:34.074211 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m13:33:34.074929 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:34.075515 [info ] [Thread-2  ]: 2 of 12 START test not_null_customers_customer_id .............................. [RUN]
[0m13:33:34.076162 [info ] [Thread-3  ]: 3 of 12 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:33:34.077204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m13:33:34.077806 [info ] [Thread-4  ]: 4 of 12 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:33:34.078896 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d'
[0m13:33:34.079923 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m13:33:34.080498 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:33:34.081892 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:33:34.082522 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:33:34.083049 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:34.096119 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:34.106056 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:33:34.114385 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:33:34.119435 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:33:34.122917 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:33:34.123993 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 13:33:34.083359 => 13:33:34.123772
[0m13:33:34.124368 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:33:34.130314 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 13:33:34.114673 => 13:33:34.130084
[0m13:33:34.137172 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:33:34.106417 => 13:33:34.136990
[0m13:33:34.137478 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 13:33:34.119743 => 13:33:34.137335
[0m13:33:34.137731 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:34.140385 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:33:34.140675 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:33:34.140938 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:34.143042 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:33:34.145094 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:33:34.147059 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:33:34.147810 [debug] [Thread-1  ]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:33:34.148199 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from analytics.raw.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m13:33:34.148677 [debug] [Thread-2  ]: Using snowflake connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:33:34.148918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:34.149327 [debug] [Thread-3  ]: Using snowflake connection "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:33:34.149608 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from analytics.raw.customers
where customer_id is null



      
    ) dbt_internal_test
[0m13:33:34.150059 [debug] [Thread-4  ]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:33:34.150687 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from analytics.raw.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:33:34.150993 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:33:34.151495 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from analytics.raw.stg_customers
where customer_id is null



      
    ) dbt_internal_test
[0m13:33:34.151770 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:33:34.152278 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:33:34.481938 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:34.487630 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 13:33:34.145312 => 13:33:34.487385
[0m13:33:34.487970 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:33:34.504339 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:34.507791 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:33:34.143282 => 13:33:34.507588
[0m13:33:34.508110 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m13:33:34.571103 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:34.572205 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:34.578433 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 13:33:34.124575 => 13:33:34.577201
[0m13:33:34.582027 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 13:33:34.141105 => 13:33:34.581835
[0m13:33:34.582371 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m13:33:34.583062 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:33:34.592625 [info ] [Thread-4  ]: 4 of 12 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.51s]
[0m13:33:34.593125 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:34.593411 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:34.593656 [info ] [Thread-4  ]: 5 of 12 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:33:34.594148 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:33:34.594422 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:34.597681 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:33:34.598482 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 13:33:34.594576 => 13:33:34.598334
[0m13:33:34.598738 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:34.601275 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:33:34.602916 [debug] [Thread-4  ]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:33:34.603256 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from analytics.raw.stg_orders
where customer_id is null



      
    ) dbt_internal_test
[0m13:33:34.603513 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:33:34.606179 [info ] [Thread-2  ]: 2 of 12 PASS not_null_customers_customer_id .................................... [[32mPASS[0m in 0.53s]
[0m13:33:34.606730 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:33:34.607202 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:34.607496 [info ] [Thread-2  ]: 6 of 12 START test not_null_stg_orders_order_id ................................ [RUN]
[0m13:33:34.608294 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:33:34.608547 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:34.611762 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:33:34.612462 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 13:33:34.608695 => 13:33:34.612310
[0m13:33:34.612703 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:34.615690 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:33:34.616922 [debug] [Thread-2  ]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:33:34.617283 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from analytics.raw.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m13:33:34.617541 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:33:34.674496 [info ] [Thread-3  ]: 3 of 12 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.60s]
[0m13:33:34.675009 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:34.675302 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:34.675553 [info ] [Thread-3  ]: 7 of 12 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:33:34.676045 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:33:34.676324 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:34.682625 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:33:34.683926 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 13:33:34.676482 => 13:33:34.683720
[0m13:33:34.684222 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:34.686338 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:33:34.687055 [info ] [Thread-1  ]: 1 of 12 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.61s]
[0m13:33:34.687630 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:33:34.687917 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:33:34.688164 [info ] [Thread-1  ]: 8 of 12 START test unique_customers_customer_id ................................ [RUN]
[0m13:33:34.688984 [debug] [Thread-3  ]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:33:34.689514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m13:33:34.689834 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from analytics.raw.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from analytics.raw.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:33:34.690110 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:33:34.690347 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:33:34.695049 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:33:34.696342 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:33:34.690494 => 13:33:34.696162
[0m13:33:34.696609 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:33:34.698873 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:33:34.701338 [debug] [Thread-1  ]: Using snowflake connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:33:34.701698 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.raw.customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:34.701954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:35.003336 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.008687 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 13:33:34.598881 => 13:33:35.008366
[0m13:33:35.010282 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:33:35.057961 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.074803 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 13:33:34.612850 => 13:33:35.074299
[0m13:33:35.075193 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:33:35.079879 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.081582 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 13:33:34.684381 => 13:33:35.081392
[0m13:33:35.081911 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:33:35.090777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.093232 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:33:34.696785 => 13:33:35.092929
[0m13:33:35.093756 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m13:33:35.117601 [info ] [Thread-4  ]: 5 of 12 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.52s]
[0m13:33:35.118177 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:35.118559 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:33:35.118955 [info ] [Thread-4  ]: 9 of 12 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m13:33:35.119570 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m13:33:35.119909 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:33:35.125364 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:33:35.128659 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 13:33:35.120114 => 13:33:35.128216
[0m13:33:35.129234 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:33:35.132850 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:33:35.135803 [debug] [Thread-4  ]: Using snowflake connection "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:33:35.136413 [debug] [Thread-4  ]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.raw.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:35.136998 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:33:35.191751 [info ] [Thread-2  ]: 6 of 12 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.58s]
[0m13:33:35.193756 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:35.192586 [info ] [Thread-3  ]: 7 of 12 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.52s]
[0m13:33:35.194249 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:35.193219 [info ] [Thread-1  ]: 8 of 12 PASS unique_customers_customer_id ...................................... [[32mPASS[0m in 0.50s]
[0m13:33:35.194909 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:35.195698 [info ] [Thread-2  ]: 10 of 12 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:33:35.196242 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:33:35.196634 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:33:35.197462 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:33:35.197925 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:33:35.198519 [info ] [Thread-3  ]: 11 of 12 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:33:35.199364 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:35.199792 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:33:35.200443 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m13:33:35.204325 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:33:35.205005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:33:35.205351 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:33:35.205762 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:33:35.209384 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:33:35.212573 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:33:35.212958 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 13:33:35.200653 => 13:33:35.212766
[0m13:33:35.213373 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:35.215615 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:33:35.216122 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 13:33:35.205983 => 13:33:35.215950
[0m13:33:35.216531 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 13:33:35.209623 => 13:33:35.216337
[0m13:33:35.216832 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:33:35.217144 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:33:35.219507 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:33:35.220085 [debug] [Thread-2  ]: Using snowflake connection "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:33:35.223050 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:33:35.223461 [debug] [Thread-2  ]: On test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.raw.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:35.223857 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:33:35.224415 [debug] [Thread-3  ]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:33:35.225196 [debug] [Thread-1  ]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:33:35.225750 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.raw.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:35.226073 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from analytics.raw.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:35.226579 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:33:35.226836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:35.472833 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.477412 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 13:33:35.129790 => 13:33:35.477033
[0m13:33:35.478433 [debug] [Thread-4  ]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:33:35.544532 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.548530 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 13:33:35.217355 => 13:33:35.548099
[0m13:33:35.549817 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:33:35.550967 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.555994 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 13:33:35.220275 => 13:33:35.555573
[0m13:33:35.556741 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:33:35.568608 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:33:35.571353 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 13:33:35.213571 => 13:33:35.571007
[0m13:33:35.571973 [debug] [Thread-2  ]: On test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:33:35.578024 [info ] [Thread-4  ]: 9 of 12 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 0.46s]
[0m13:33:35.579134 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:33:36.136771 [info ] [Thread-2  ]: 10 of 12 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.94s]
[0m13:33:36.137374 [info ] [Thread-1  ]: 12 of 12 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.93s]
[0m13:33:36.138355 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:36.137970 [info ] [Thread-3  ]: 11 of 12 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.94s]
[0m13:33:36.138762 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:33:36.139184 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:33:36.140312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:36.140522 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:33:36.140709 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:33:36.140885 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:33:36.141062 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:33:36.141278 [info ] [MainThread]: 
[0m13:33:36.141507 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m13:33:36.142652 [debug] [MainThread]: Command end result
[0m13:33:36.150331 [info ] [MainThread]: 
[0m13:33:36.150717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:36.150973 [info ] [MainThread]: 
[0m13:33:36.151238 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m13:33:36.152673 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1736617, "process_user_time": 2.102028, "process_kernel_time": 0.251996, "process_mem_max_rss": "134053888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:33:36.153067 [debug] [MainThread]: Command `dbt test` succeeded at 13:33:36.152986 after 3.17 seconds
[0m13:33:36.153338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10228e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10393a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105092c10>]}
[0m13:33:36.153598 [debug] [MainThread]: Flushing usage events
[0m13:35:04.277279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c5e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10271fc40>]}


============================== 13:35:04.280389 | 760f251c-9481-4bb8-abc7-7e5025006696 ==============================
[0m13:35:04.280389 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:35:04.280790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:04.497870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '760f251c-9481-4bb8-abc7-7e5025006696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498a220>]}
[0m13:35:04.573471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '760f251c-9481-4bb8-abc7-7e5025006696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521b8e0>]}
[0m13:35:04.574288 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:35:04.584914 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:35:04.630197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:04.630499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:04.634387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '760f251c-9481-4bb8-abc7-7e5025006696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f5970>]}
[0m13:35:04.636380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '760f251c-9481-4bb8-abc7-7e5025006696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055023d0>]}
[0m13:35:04.636658 [info ] [MainThread]: Found 6 models, 12 tests, 2 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m13:35:04.636896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '760f251c-9481-4bb8-abc7-7e5025006696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105502490>]}
[0m13:35:04.638109 [info ] [MainThread]: 
[0m13:35:04.638559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:35:04.639370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_raw'
[0m13:35:04.648752 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m13:35:04.649247 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m13:35:04.649489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:05.222291 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:35:05.226074 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m13:35:05.327296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '760f251c-9481-4bb8-abc7-7e5025006696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105321fa0>]}
[0m13:35:05.328845 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:05.329501 [info ] [MainThread]: 
[0m13:35:05.334449 [debug] [Thread-1  ]: Began running node model.jaffle_shop.initial_file
[0m13:35:05.335173 [debug] [Thread-2  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:35:05.335876 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_customers
[0m13:35:05.336898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.initial_file)
[0m13:35:05.337472 [debug] [Thread-4  ]: Began running node model.jaffle_shop.stg_orders
[0m13:35:05.338498 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m13:35:05.339488 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m13:35:05.340069 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.initial_file
[0m13:35:05.341124 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:35:05.341698 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:35:05.342230 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_customers
[0m13:35:05.351625 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m13:35:05.352236 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.stg_orders
[0m13:35:05.355830 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:35:05.358894 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:35:05.362133 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:35:05.362994 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (compile): 13:35:05.342567 => 13:35:05.362673
[0m13:35:05.363640 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.initial_file
[0m13:35:05.364401 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (compile): 13:35:05.356130 => 13:35:05.364134
[0m13:35:05.364954 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (execute): 13:35:05.364713 => 13:35:05.364735
[0m13:35:05.365357 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (compile): 13:35:05.359308 => 13:35:05.365166
[0m13:35:05.365787 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 13:35:05.352582 => 13:35:05.365560
[0m13:35:05.366186 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_customers
[0m13:35:05.367137 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.initial_file
[0m13:35:05.367521 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.stg_orders
[0m13:35:05.367892 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:35:05.368322 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (execute): 13:35:05.368133 => 13:35:05.368138
[0m13:35:05.368837 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (execute): 13:35:05.368638 => 13:35:05.368643
[0m13:35:05.369254 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 13:35:05.369061 => 13:35:05.369065
[0m13:35:05.370070 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_customers
[0m13:35:05.370848 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.stg_orders
[0m13:35:05.371623 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:35:05.372263 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:35:05.372767 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:35:05.373170 [debug] [Thread-2  ]: Began running node model.jaffle_shop.customers
[0m13:35:05.373541 [debug] [Thread-4  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:35:05.374198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.initial_file, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:35:05.374805 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m13:35:05.375338 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.customers)
[0m13:35:05.375861 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m13:35:05.376188 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:35:05.376503 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:35:05.376808 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.customers
[0m13:35:05.377119 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:35:05.387517 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:35:05.392404 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:35:05.395624 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:35:05.402756 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:35:05.403650 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 13:35:05.387769 => 13:35:05.403466
[0m13:35:05.403986 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 13:35:05.377312 => 13:35:05.403827
[0m13:35:05.404248 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:35:05.404544 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 13:35:05.395830 => 13:35:05.404394
[0m13:35:05.404828 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.customers (compile): 13:35:05.392636 => 13:35:05.404694
[0m13:35:05.405086 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:35:05.405392 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 13:35:05.405252 => 13:35:05.405257
[0m13:35:05.405649 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:35:05.405903 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.customers
[0m13:35:05.406199 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 13:35:05.406059 => 13:35:05.406063
[0m13:35:05.406803 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:35:05.407102 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 13:35:05.406963 => 13:35:05.406966
[0m13:35:05.407402 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.customers (execute): 13:35:05.407268 => 13:35:05.407271
[0m13:35:05.407957 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:35:05.408227 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:35:05.408801 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:35:05.409312 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.customers
[0m13:35:05.409572 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:35:05.409984 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:35:05.410259 [debug] [Thread-4  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:35:05.410540 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:35:05.410988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:35:05.411233 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:35:05.411636 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:35:05.412031 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:35:05.412269 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:35:05.415089 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:35:05.415353 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:35:05.415592 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:35:05.418178 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:35:05.423202 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:35:05.425779 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:35:05.426125 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 13:35:05.412409 => 13:35:05.425992
[0m13:35:05.426516 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 13:35:05.415736 => 13:35:05.426375
[0m13:35:05.426788 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:35:05.427049 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:35:05.427366 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 13:35:05.427231 => 13:35:05.427236
[0m13:35:05.427616 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 13:35:05.418399 => 13:35:05.427495
[0m13:35:05.427903 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 13:35:05.427767 => 13:35:05.427771
[0m13:35:05.428167 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 13:35:05.423399 => 13:35:05.428041
[0m13:35:05.428686 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:35:05.428921 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:35:05.429430 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:35:05.429662 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:35:05.429942 [debug] [Thread-3  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:35:05.430239 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 13:35:05.430108 => 13:35:05.430111
[0m13:35:05.430488 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:35:05.430767 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 13:35:05.430646 => 13:35:05.430649
[0m13:35:05.431148 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now model.jaffle_shop.my_second_dbt_model)
[0m13:35:05.431658 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:35:05.432031 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m13:35:05.432544 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:35:05.432763 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:35:05.433013 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:35:05.433248 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:35:05.433495 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:35:05.435246 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:35:05.435641 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:35:05.438700 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:35:05.439090 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m13:35:05.439367 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:35:05.439648 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:35:05.442192 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:35:05.444617 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:35:05.444930 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 13:35:05.433650 => 13:35:05.444796
[0m13:35:05.445178 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 13:35:05.435791 => 13:35:05.445062
[0m13:35:05.445464 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:35:05.445742 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:35:05.446023 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 13:35:05.445894 => 13:35:05.445898
[0m13:35:05.446288 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:35:05.439794 => 13:35:05.446159
[0m13:35:05.446556 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 13:35:05.446434 => 13:35:05.446437
[0m13:35:05.446800 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:35:05.442397 => 13:35:05.446684
[0m13:35:05.447317 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:35:05.447539 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:35:05.448048 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:35:05.448275 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:35:05.448624 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:35:05.448493 => 13:35:05.448496
[0m13:35:05.448933 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:35:05.449166 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:35:05.449448 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:35:05.449328 => 13:35:05.449331
[0m13:35:05.449936 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:35:05.450439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m13:35:05.450816 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:35:05.451311 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:35:05.451580 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:35:05.451815 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:35:05.454599 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:35:05.457137 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:35:05.457878 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 13:35:05.454815 => 13:35:05.457737
[0m13:35:05.458111 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:35:05.458396 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 13:35:05.452000 => 13:35:05.458257
[0m13:35:05.458659 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 13:35:05.458533 => 13:35:05.458538
[0m13:35:05.458888 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:35:05.459404 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:35:05.459665 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 13:35:05.459540 => 13:35:05.459543
[0m13:35:05.460220 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:35:05.460737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:05.460938 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m13:35:05.461112 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:35:05.461279 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:35:05.461444 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:35:05.462827 [debug] [MainThread]: Command end result
[0m13:35:05.471545 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m13:35:05.471781 [info ] [MainThread]: Building catalog
[0m13:35:05.472788 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m13:35:05.483875 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m13:35:05.484416 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from analytics.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'initial_file' and upper("table_name") = upper('initial_file')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from analytics.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'initial_file' and upper("table_name") = upper('initial_file')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m13:35:05.484807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:08.556315 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 3.0 seconds
[0m13:35:08.574172 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m13:35:08.692060 [info ] [MainThread]: Catalog written to /Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/target/catalog.json
[0m13:35:08.694970 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.4632134, "process_user_time": 1.740327, "process_kernel_time": 0.204757, "process_mem_max_rss": "130072576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:35:08.695998 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:35:08.695786 after 4.46 seconds
[0m13:35:08.696555 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:35:08.697048 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m13:35:08.697561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c5e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521b8e0>]}
[0m13:35:08.698129 [debug] [MainThread]: Flushing usage events
[0m13:40:36.278522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ae670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106156f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106183730>]}


============================== 13:40:36.281910 | 5f51e55e-1657-4e00-83e1-a8d780b91885 ==============================
[0m13:40:36.281910 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:40:36.282318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/logs', 'debug': 'False', 'profiles_dir': '/Users/yiting.chen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:36.507276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f51e55e-1657-4e00-83e1-a8d780b91885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615e6a0>]}
[0m13:40:36.582159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f51e55e-1657-4e00-83e1-a8d780b91885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aac1f0>]}
[0m13:40:36.583240 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:40:36.594497 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:40:36.641588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:36.641904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:36.645855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f51e55e-1657-4e00-83e1-a8d780b91885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dccfd0>]}
[0m13:40:36.647783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f51e55e-1657-4e00-83e1-a8d780b91885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd6490>]}
[0m13:40:36.648084 [info ] [MainThread]: Found 6 models, 12 tests, 2 sources, 0 exposures, 0 metrics, 441 macros, 0 groups, 0 semantic models
[0m13:40:36.648322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f51e55e-1657-4e00-83e1-a8d780b91885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd6550>]}
[0m13:40:36.649545 [info ] [MainThread]: 
[0m13:40:36.650028 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:36.650861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_raw'
[0m13:40:36.659927 [debug] [ThreadPool]: Using snowflake connection "list_analytics_raw"
[0m13:40:36.660249 [debug] [ThreadPool]: On list_analytics_raw: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "list_analytics_raw"} */
show objects in analytics.raw limit 10000
[0m13:40:36.660462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:37.228261 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:40:37.232143 [debug] [ThreadPool]: On list_analytics_raw: Close
[0m13:40:37.320450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f51e55e-1657-4e00-83e1-a8d780b91885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0d7c0>]}
[0m13:40:37.321997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:37.322649 [info ] [MainThread]: 
[0m13:40:37.328763 [debug] [Thread-1  ]: Began running node model.jaffle_shop.initial_file
[0m13:40:37.329524 [debug] [Thread-2  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:40:37.330143 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_customers
[0m13:40:37.331205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_raw, now model.jaffle_shop.initial_file)
[0m13:40:37.331781 [debug] [Thread-4  ]: Began running node model.jaffle_shop.stg_orders
[0m13:40:37.332829 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m13:40:37.333834 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m13:40:37.334394 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.initial_file
[0m13:40:37.335461 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:40:37.336040 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:40:37.336594 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_customers
[0m13:40:37.345749 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.initial_file"
[0m13:40:37.346345 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.stg_orders
[0m13:40:37.350342 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:40:37.353520 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:40:37.356822 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:40:37.357611 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (compile): 13:40:37.336940 => 13:40:37.357355
[0m13:40:37.358132 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.initial_file
[0m13:40:37.358601 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.initial_file (execute): 13:40:37.358391 => 13:40:37.358407
[0m13:40:37.359091 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (compile): 13:40:37.350715 => 13:40:37.358871
[0m13:40:37.359503 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 13:40:37.346911 => 13:40:37.359315
[0m13:40:37.360472 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.initial_file
[0m13:40:37.360889 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_customers
[0m13:40:37.361354 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (compile): 13:40:37.353958 => 13:40:37.361133
[0m13:40:37.361717 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:40:37.362285 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_customers (execute): 13:40:37.362075 => 13:40:37.362081
[0m13:40:37.362646 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.stg_orders
[0m13:40:37.363084 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 13:40:37.362870 => 13:40:37.362877
[0m13:40:37.363926 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_customers
[0m13:40:37.364345 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.stg_orders (execute): 13:40:37.364153 => 13:40:37.364158
[0m13:40:37.365138 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:40:37.366106 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.stg_orders
[0m13:40:37.366466 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:40:37.366869 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:40:37.367459 [debug] [Thread-2  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:40:37.367886 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:40:37.368529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.initial_file, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:40:37.369091 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m13:40:37.369638 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m13:40:37.370171 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m13:40:37.370498 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:40:37.370827 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:40:37.371146 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:40:37.371456 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:40:37.381805 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:40:37.386633 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:40:37.389519 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:40:37.392470 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m13:40:37.393487 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 13:40:37.382060 => 13:40:37.393317
[0m13:40:37.393814 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 13:40:37.389723 => 13:40:37.393652
[0m13:40:37.394077 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:40:37.394377 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 13:40:37.386880 => 13:40:37.394225
[0m13:40:37.394660 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 13:40:37.371653 => 13:40:37.394524
[0m13:40:37.394995 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:40:37.395310 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 13:40:37.395163 => 13:40:37.395170
[0m13:40:37.395564 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:40:37.395818 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:40:37.396122 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 13:40:37.395978 => 13:40:37.395982
[0m13:40:37.397462 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:40:37.397767 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 13:40:37.397626 => 13:40:37.397630
[0m13:40:37.398062 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 13:40:37.397927 => 13:40:37.397931
[0m13:40:37.398664 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m13:40:37.404516 [debug] [Thread-3  ]: Began running node model.jaffle_shop.customers
[0m13:40:37.405128 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:40:37.405752 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:40:37.406059 [debug] [Thread-4  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:40:37.406555 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now model.jaffle_shop.customers)
[0m13:40:37.406883 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:40:37.407229 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:40:37.407768 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m13:40:37.408058 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.customers
[0m13:40:37.408505 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:40:37.408964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:40:37.409251 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:40:37.411775 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:40:37.412061 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:40:37.412316 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:40:37.419344 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m13:40:37.424155 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:40:37.429211 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:40:37.433020 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.customers (compile): 13:40:37.409419 => 13:40:37.432866
[0m13:40:37.433591 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.customers
[0m13:40:37.433954 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.customers (execute): 13:40:37.433805 => 13:40:37.433810
[0m13:40:37.438143 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.customers
[0m13:40:37.438480 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 13:40:37.426472 => 13:40:37.438314
[0m13:40:37.438814 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:40:37.439181 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 13:40:37.421437 => 13:40:37.439030
[0m13:40:37.439509 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 13:40:37.412479 => 13:40:37.439351
[0m13:40:37.439827 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:40:37.440316 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:40:37.440608 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:40:37.440903 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:40:37.441234 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 13:40:37.441085 => 13:40:37.441090
[0m13:40:37.441509 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:40:37.441829 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 13:40:37.441681 => 13:40:37.441685
[0m13:40:37.442153 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 13:40:37.441998 => 13:40:37.442002
[0m13:40:37.442759 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:40:37.449319 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:40:37.449956 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:40:37.450542 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m13:40:37.450849 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:40:37.451205 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:40:37.451507 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:40:37.451985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:40:37.452423 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m13:40:37.452712 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 13:40:37.442930 => 13:40:37.452570
[0m13:40:37.453141 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:40:37.453406 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:40:37.453660 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:40:37.453918 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:40:37.454164 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:40:37.456937 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:40:37.459610 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m13:40:37.459925 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 13:40:37.459783 => 13:40:37.459788
[0m13:40:37.462566 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:40:37.463251 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:40:37.463593 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:40:37.464005 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:40:37.464250 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:40:37.464547 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 13:40:37.454320 => 13:40:37.464412
[0m13:40:37.467280 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:40:37.467590 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:40:37.467947 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 13:40:37.460078 => 13:40:37.467808
[0m13:40:37.468230 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 13:40:37.468086 => 13:40:37.468091
[0m13:40:37.468486 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 13:40:37.457115 => 13:40:37.468367
[0m13:40:37.468741 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:40:37.469021 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:40:37.464684 => 13:40:37.468888
[0m13:40:37.469541 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:40:37.469778 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:40:37.470046 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 13:40:37.469927 => 13:40:37.469930
[0m13:40:37.470268 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:40:37.470515 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:40:37.470798 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 13:40:37.470673 => 13:40:37.470676
[0m13:40:37.471304 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m13:40:37.471562 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:40:37.471445 => 13:40:37.471447
[0m13:40:37.471929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m13:40:37.472429 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m13:40:37.473011 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:40:37.473241 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:40:37.475898 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:40:37.476476 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:40:37.473478 => 13:40:37.476347
[0m13:40:37.476696 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:40:37.476945 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:40:37.476829 => 13:40:37.476832
[0m13:40:37.477435 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:40:37.477977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:37.478178 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:40:37.478355 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m13:40:37.478528 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:40:37.478700 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:40:37.480125 [debug] [MainThread]: Command end result
[0m13:40:37.488888 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m13:40:37.489135 [info ] [MainThread]: Building catalog
[0m13:40:37.490154 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m13:40:37.500857 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m13:40:37.501357 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "dbt_course_learning", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from analytics.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'initial_file' and upper("table_name") = upper('initial_file')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from analytics.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'initial_file' and upper("table_name") = upper('initial_file')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m13:40:37.501742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:40.371212 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 3.0 seconds
[0m13:40:40.389509 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m13:40:40.517826 [info ] [MainThread]: Catalog written to /Users/yiting.chen/Documents/code/personal/dbt_course/dbt_course_learning/target/catalog.json
[0m13:40:40.520651 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.287831, "process_user_time": 1.725763, "process_kernel_time": 0.205935, "process_mem_max_rss": "130678784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:40:40.521692 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:40:40.521492 after 4.29 seconds
[0m13:40:40.522223 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:40:40.522616 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m13:40:40.523053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ae670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b3b50>]}
[0m13:40:40.523563 [debug] [MainThread]: Flushing usage events
